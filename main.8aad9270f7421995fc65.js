(()=>{"use strict";var e={186:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-right2429af6d3a5796e3c34b.png"},227:(e,t,r)=>{e.exports=r.p+"assets/undeadf5c75398bcb5931f9f3c.png"},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},756:(e,t,r)=>{e.exports=r.p+"assets/vampirebf0ed0dca1d1e6091d42.png"},1016:(e,t,r)=>{r.d(t,{A:()=>We});var n=r(1354),a=r.n(n),i=r(6314),s=r.n(i),l=r(4417),o=r.n(l),c=new URL(r(7935),r.b),h=new URL(r(1409),r.b),p=new URL(r(3232),r.b),d=new URL(r(1265),r.b),m=new URL(r(6267),r.b),u=new URL(r(186),r.b),A=new URL(r(9745),r.b),g=new URL(r(8490),r.b),f=new URL(r(2573),r.b),b=new URL(r(4496),r.b),v=new URL(r(8956),r.b),E=new URL(r(9221),r.b),C=new URL(r(6092),r.b),y=new URL(r(4184),r.b),w=new URL(r(5513),r.b),x=new URL(r(3062),r.b),k=new URL(r(4875),r.b),B=new URL(r(5134),r.b),L=new URL(r(7335),r.b),P=new URL(r(6153),r.b),D=new URL(r(9e3),r.b),S=new URL(r(9593),r.b),T=new URL(r(5523),r.b),z=new URL(r(7986),r.b),R=new URL(r(4041),r.b),U=new URL(r(7538),r.b),M=new URL(r(1605),r.b),$=new URL(r(6318),r.b),G=new URL(r(3933),r.b),j=new URL(r(6291),r.b),I=new URL(r(9702),r.b),O=new URL(r(1906),r.b),H=new URL(r(4347),r.b),q=new URL(r(1216),r.b),N=new URL(r(4437),r.b),W=new URL(r(3160),r.b),_=new URL(r(8341),r.b),F=new URL(r(2076),r.b),Y=new URL(r(3860),r.b),X=new URL(r(6943),r.b),J=new URL(r(6168),r.b),Q=new URL(r(227),r.b),V=new URL(r(756),r.b),Z=new URL(r(9334),r.b),K=s()(a()),ee=o()(c),te=o()(h),re=o()(p),ne=o()(d),ae=o()(m),ie=o()(u),se=o()(A),le=o()(g),oe=o()(f),ce=o()(b),he=o()(v),pe=o()(E),de=o()(C),me=o()(y),ue=o()(w),Ae=o()(x),ge=o()(k),fe=o()(B),be=o()(L),ve=o()(P),Ee=o()(D),Ce=o()(S),ye=o()(T),we=o()(z),xe=o()(R),ke=o()(U),Be=o()(M),Le=o()($),Pe=o()(G),De=o()(j),Se=o()(I),Te=o()(O),ze=o()(H),Re=o()(q),Ue=o()(N),Me=o()(W),$e=o()(_),Ge=o()(F),je=o()(Y),Ie=o()(X),Oe=o()(J),He=o()(Q),qe=o()(V),Ne=o()(Z);K.push([e.id,`:root {\n  --cell-size: 64px;\n}\n\nhtml, body {\n  height: 100%;\n  margin: 0;\n}\n\nbody {\n  background: #000;\n  font-size: 16px;\n}\n\n.btn {\n  display: inline-block;\n  font-weight: 400;\n  color: #212529;\n  background-color: #f8f9fa;\n  text-align: center;\n  vertical-align: middle;\n  padding: .375rem .75rem;\n  font-size: 1rem;\n  line-height: 1.5;\n  border-radius: .25rem;\n  transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;\n  border: none;\n}\n\n.controls {\n  text-align: center;\n  margin: 50px 0;\n}\n\n.board-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n}\n\n.board {\n  display: grid;\n  grid-template-columns: repeat(8, 1fr);\n  grid-column-gap: 2px;\n  grid-row-gap: 2px;\n}\n\n.cell {\n  position: relative;\n}\n\n.cell.selected::before {\n  content: '';\n  display: block;\n  border: 4px;\n  border-radius: 32px;\n  box-sizing: border-box;\n  width: var(--cell-size);\n  height: var(--cell-size);\n  opacity: 0.9;\n  position: absolute;\n}\n\n.cell.selected-yellow::before {\n  border-color: #ff0;\n  border-style: solid;\n}\n\n.cell.selected-green::before {\n  border-color: #0f0;\n  border-style: dashed;\n}\n\n.cell.selected-red::before {\n  border-color: #f00;\n  border-style: dashed;\n}\n\n.board.prairie {\n  --map-tile-top-left-url: url(${ee});\n  --map-tile-top-url: url(${te});\n  --map-tile-top-right-url: url(${re});\n  --map-tile-bottom-left-url: url(${ne});\n  --map-tile-bottom-url: url(${ae});\n  --map-tile-bottom-right-url: url(${ie});\n  --map-tile-left-url: url(${se});\n  --map-tile-right-url: url(${le});\n  --map-tile-center-url: url(${oe});\n}\n\n.board.desert {\n  --map-tile-top-left-url: url(${ce});\n  --map-tile-top-url: url(${he});\n  --map-tile-top-right-url: url(${pe});\n  --map-tile-bottom-left-url: url(${de});\n  --map-tile-bottom-url: url(${me});\n  --map-tile-bottom-right-url: url(${ue});\n  --map-tile-left-url: url(${Ae});\n  --map-tile-right-url: url(${ge});\n  --map-tile-center-url: url(${fe});\n}\n\n.board.arctic {\n  --map-tile-top-left-url: url(${be});\n  --map-tile-top-url: url(${ve});\n  --map-tile-top-right-url: url(${Ee});\n  --map-tile-bottom-left-url: url(${Ce});\n  --map-tile-bottom-url: url(${ye});\n  --map-tile-bottom-right-url: url(${we});\n  --map-tile-left-url: url(${xe});\n  --map-tile-right-url: url(${ke});\n  --map-tile-center-url: url(${Be});\n}\n\n.board.mountain {\n  --map-tile-top-left-url: url(${Le});\n  --map-tile-top-url: url(${Pe});\n  --map-tile-top-right-url: url(${De});\n  --map-tile-bottom-left-url: url(${Se});\n  --map-tile-bottom-url: url(${Te});\n  --map-tile-bottom-right-url: url(${ze});\n  --map-tile-left-url: url(${Re});\n  --map-tile-right-url: url(${Ue});\n  --map-tile-center-url: url(${Me});\n}\n\n.map-tile {\n  width: var(--cell-size);\n  height: var(--cell-size);\n}\n\n.map-tile-top-left {\n  background: var(--map-tile-top-left-url);\n}\n\n.map-tile-top {\n  background: var(--map-tile-top-url);\n}\n\n.map-tile-top-right {\n  background: var(--map-tile-top-right-url);\n}\n\n.map-tile-bottom-left {\n  background: var(--map-tile-bottom-left-url);\n}\n\n.map-tile-bottom {\n  background: var(--map-tile-bottom-url);\n}\n\n.map-tile-bottom-right {\n  background: var(--map-tile-bottom-right-url);\n}\n\n.map-tile-left {\n  background: var(--map-tile-left-url);\n}\n\n.map-tile-right {\n  background: var(--map-tile-right-url);\n}\n\n.map-tile-center {\n  background: var(--map-tile-center-url);\n}\n\n.character {\n  width: var(--cell-size);\n  height: var(--cell-size);\n  position: absolute;\n  z-index: 99;\n}\n\n.character.generic {\n  background: url(${$e});\n}\n\n.character.bowman {\n  background: url(${Ge});\n}\n\n.character.daemon {\n  background: url(${je});\n}\n\n.character.magician {\n  background: url(${Ie});\n}\n\n.character.swordsman {\n  background: url(${Oe});\n}\n\n.character.undead {\n  background: url(${He});\n}\n\n.character.vampire {\n  background: url(${qe});\n}\n\n.character.zombie {\n  background: url(${Ne});\n}\n\n.health-level {\n  top: 2px;\n  left: 7px;\n  position: absolute;\n  width: 50px;\n  height: 4px;\n  background: #000;\n}\n\n.health-level-indicator {\n  height: 4px;\n}\n\n.health-level-indicator-high {\n  background: #0f0;\n}\n\n.health-level-indicator-normal {\n  background: #ff0;\n}\n\n.health-level-indicator-critical {\n  background: #f00;\n}\n\n.damage {\n  position: absolute;\n  width: var(--cell-size);\n  text-align: center;\n  z-index: 999;\n  color: #f00;\n  font-weight: bold;\n  animation: 500ms fade ease-out;\n}\n\n@keyframes fade {\n  from {\n    opacity: 0;\n    top: calc(var(--cell-size) * 0.5);\n    font-size: 1rem;\n  }\n  to {\n    opacity: 1;\n    top: -20px;\n    font-size: 1.5rem;\n  }\n}\n`,"",{version:3,sources:["webpack://./src/css/style.css"],names:[],mappings:"AAAA;EACE,iBAAiB;AACnB;;AAEA;EACE,YAAY;EACZ,SAAS;AACX;;AAEA;EACE,gBAAgB;EAChB,eAAe;AACjB;;AAEA;EACE,qBAAqB;EACrB,gBAAgB;EAChB,cAAc;EACd,yBAAyB;EACzB,kBAAkB;EAClB,sBAAsB;EACtB,uBAAuB;EACvB,eAAe;EACf,gBAAgB;EAChB,qBAAqB;EACrB,8HAA8H;EAC9H,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,cAAc;AAChB;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;EACvB,eAAe;AACjB;;AAEA;EACE,aAAa;EACb,qCAAqC;EACrC,oBAAoB;EACpB,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,WAAW;EACX,cAAc;EACd,WAAW;EACX,mBAAmB;EACnB,sBAAsB;EACtB,uBAAuB;EACvB,wBAAwB;EACxB,YAAY;EACZ,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,mBAAmB;AACrB;;AAEA;EACE,kBAAkB;EAClB,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;EAClB,oBAAoB;AACtB;;AAEA;EACE,gEAAoE;EACpE,2DAA0D;EAC1D,iEAAsE;EACtE,mEAA0E;EAC1E,8DAAgE;EAChE,oEAA4E;EAC5E,4DAA4D;EAC5D,6DAA8D;EAC9D,8DAAgE;AAClE;;AAEA;EACE,gEAAmE;EACnE,4DAAyD;EACzD,kEAAqE;EACrE,oEAAyE;EACzE,+DAA+D;EAC/D,qEAA2E;EAC3E,6DAA2D;EAC3D,8DAA6D;EAC7D,+DAA+D;AACjE;;AAEA;EACE,iEAAmE;EACnE,4DAAyD;EACzD,kEAAqE;EACrE,oEAAyE;EACzE,+DAA+D;EAC/D,qEAA2E;EAC3E,6DAA2D;EAC3D,8DAA6D;EAC7D,+DAA+D;AACjE;;AAEA;EACE,iEAAqE;EACrE,4DAA2D;EAC3D,kEAAuE;EACvE,oEAA2E;EAC3E,+DAAiE;EACjE,qEAA6E;EAC7E,6DAA6D;EAC7D,8DAA+D;EAC/D,+DAAiE;AACnE;;AAEA;EACE,uBAAuB;EACvB,wBAAwB;AAC1B;;AAEA;EACE,wCAAwC;AAC1C;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,yCAAyC;AAC3C;;AAEA;EACE,2CAA2C;AAC7C;;AAEA;EACE,sCAAsC;AACxC;;AAEA;EACE,4CAA4C;AAC9C;;AAEA;EACE,oCAAoC;AACtC;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sCAAsC;AACxC;;AAEA;EACE,uBAAuB;EACvB,wBAAwB;EACxB,kBAAkB;EAClB,WAAW;AACb;;AAEA;EACE,oDAAgD;AAClD;;AAEA;EACE,oDAA+C;AACjD;;AAEA;EACE,oDAA+C;AACjD;;AAEA;EACE,oDAAiD;AACnD;;AAEA;EACE,oDAAkD;AACpD;;AAEA;EACE,oDAA+C;AACjD;;AAEA;EACE,oDAAgD;AAClD;;AAEA;EACE,oDAA+C;AACjD;;AAEA;EACE,QAAQ;EACR,SAAS;EACT,kBAAkB;EAClB,WAAW;EACX,WAAW;EACX,gBAAgB;AAClB;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,iBAAiB;EACjB,8BAA8B;AAChC;;AAEA;EACE;IACE,UAAU;IACV,iCAAiC;IACjC,eAAe;EACjB;EACA;IACE,UAAU;IACV,UAAU;IACV,iBAAiB;EACnB;AACF",sourcesContent:[":root {\r\n  --cell-size: 64px;\r\n}\r\n\r\nhtml, body {\r\n  height: 100%;\r\n  margin: 0;\r\n}\r\n\r\nbody {\r\n  background: #000;\r\n  font-size: 16px;\r\n}\r\n\r\n.btn {\r\n  display: inline-block;\r\n  font-weight: 400;\r\n  color: #212529;\r\n  background-color: #f8f9fa;\r\n  text-align: center;\r\n  vertical-align: middle;\r\n  padding: .375rem .75rem;\r\n  font-size: 1rem;\r\n  line-height: 1.5;\r\n  border-radius: .25rem;\r\n  transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;\r\n  border: none;\r\n}\r\n\r\n.controls {\r\n  text-align: center;\r\n  margin: 50px 0;\r\n}\r\n\r\n.board-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.board {\r\n  display: grid;\r\n  grid-template-columns: repeat(8, 1fr);\r\n  grid-column-gap: 2px;\r\n  grid-row-gap: 2px;\r\n}\r\n\r\n.cell {\r\n  position: relative;\r\n}\r\n\r\n.cell.selected::before {\r\n  content: '';\r\n  display: block;\r\n  border: 4px;\r\n  border-radius: 32px;\r\n  box-sizing: border-box;\r\n  width: var(--cell-size);\r\n  height: var(--cell-size);\r\n  opacity: 0.9;\r\n  position: absolute;\r\n}\r\n\r\n.cell.selected-yellow::before {\r\n  border-color: #ff0;\r\n  border-style: solid;\r\n}\r\n\r\n.cell.selected-green::before {\r\n  border-color: #0f0;\r\n  border-style: dashed;\r\n}\r\n\r\n.cell.selected-red::before {\r\n  border-color: #f00;\r\n  border-style: dashed;\r\n}\r\n\r\n.board.prairie {\r\n  --map-tile-top-left-url: url('../img/prairie/map-tile-top-left.png');\r\n  --map-tile-top-url: url('../img/prairie/map-tile-top.png');\r\n  --map-tile-top-right-url: url('../img/prairie/map-tile-top-right.png');\r\n  --map-tile-bottom-left-url: url('../img/prairie/map-tile-bottom-left.png');\r\n  --map-tile-bottom-url: url('../img/prairie/map-tile-bottom.png');\r\n  --map-tile-bottom-right-url: url('../img/prairie/map-tile-bottom-right.png');\r\n  --map-tile-left-url: url('../img/prairie/map-tile-left.png');\r\n  --map-tile-right-url: url('../img/prairie/map-tile-right.png');\r\n  --map-tile-center-url: url('../img/prairie/map-tile-center.png');\r\n}\r\n\r\n.board.desert {\r\n  --map-tile-top-left-url: url('../img/desert/map-tile-top-left.png');\r\n  --map-tile-top-url: url('../img/desert/map-tile-top.png');\r\n  --map-tile-top-right-url: url('../img/desert/map-tile-top-right.png');\r\n  --map-tile-bottom-left-url: url('../img/desert/map-tile-bottom-left.png');\r\n  --map-tile-bottom-url: url('../img/desert/map-tile-bottom.png');\r\n  --map-tile-bottom-right-url: url('../img/desert/map-tile-bottom-right.png');\r\n  --map-tile-left-url: url('../img/desert/map-tile-left.png');\r\n  --map-tile-right-url: url('../img/desert/map-tile-right.png');\r\n  --map-tile-center-url: url('../img/desert/map-tile-center.png');\r\n}\r\n\r\n.board.arctic {\r\n  --map-tile-top-left-url: url('../img/arctic/map-tile-top-left.png');\r\n  --map-tile-top-url: url('../img/arctic/map-tile-top.png');\r\n  --map-tile-top-right-url: url('../img/arctic/map-tile-top-right.png');\r\n  --map-tile-bottom-left-url: url('../img/arctic/map-tile-bottom-left.png');\r\n  --map-tile-bottom-url: url('../img/arctic/map-tile-bottom.png');\r\n  --map-tile-bottom-right-url: url('../img/arctic/map-tile-bottom-right.png');\r\n  --map-tile-left-url: url('../img/arctic/map-tile-left.png');\r\n  --map-tile-right-url: url('../img/arctic/map-tile-right.png');\r\n  --map-tile-center-url: url('../img/arctic/map-tile-center.png');\r\n}\r\n\r\n.board.mountain {\r\n  --map-tile-top-left-url: url('../img/mountain/map-tile-top-left.png');\r\n  --map-tile-top-url: url('../img/mountain/map-tile-top.png');\r\n  --map-tile-top-right-url: url('../img/mountain/map-tile-top-right.png');\r\n  --map-tile-bottom-left-url: url('../img/mountain/map-tile-bottom-left.png');\r\n  --map-tile-bottom-url: url('../img/mountain/map-tile-bottom.png');\r\n  --map-tile-bottom-right-url: url('../img/mountain/map-tile-bottom-right.png');\r\n  --map-tile-left-url: url('../img/mountain/map-tile-left.png');\r\n  --map-tile-right-url: url('../img/mountain/map-tile-right.png');\r\n  --map-tile-center-url: url('../img/mountain/map-tile-center.png');\r\n}\r\n\r\n.map-tile {\r\n  width: var(--cell-size);\r\n  height: var(--cell-size);\r\n}\r\n\r\n.map-tile-top-left {\r\n  background: var(--map-tile-top-left-url);\r\n}\r\n\r\n.map-tile-top {\r\n  background: var(--map-tile-top-url);\r\n}\r\n\r\n.map-tile-top-right {\r\n  background: var(--map-tile-top-right-url);\r\n}\r\n\r\n.map-tile-bottom-left {\r\n  background: var(--map-tile-bottom-left-url);\r\n}\r\n\r\n.map-tile-bottom {\r\n  background: var(--map-tile-bottom-url);\r\n}\r\n\r\n.map-tile-bottom-right {\r\n  background: var(--map-tile-bottom-right-url);\r\n}\r\n\r\n.map-tile-left {\r\n  background: var(--map-tile-left-url);\r\n}\r\n\r\n.map-tile-right {\r\n  background: var(--map-tile-right-url);\r\n}\r\n\r\n.map-tile-center {\r\n  background: var(--map-tile-center-url);\r\n}\r\n\r\n.character {\r\n  width: var(--cell-size);\r\n  height: var(--cell-size);\r\n  position: absolute;\r\n  z-index: 99;\r\n}\r\n\r\n.character.generic {\r\n  background: url('../img/characters/generic.png');\r\n}\r\n\r\n.character.bowman {\r\n  background: url('../img/characters/bowman.png');\r\n}\r\n\r\n.character.daemon {\r\n  background: url('../img/characters/daemon.png');\r\n}\r\n\r\n.character.magician {\r\n  background: url('../img/characters/magician.png');\r\n}\r\n\r\n.character.swordsman {\r\n  background: url('../img/characters/swordsman.png');\r\n}\r\n\r\n.character.undead {\r\n  background: url('../img/characters/undead.png');\r\n}\r\n\r\n.character.vampire {\r\n  background: url('../img/characters/vampire.png');\r\n}\r\n\r\n.character.zombie {\r\n  background: url('../img/characters/zombie.png');\r\n}\r\n\r\n.health-level {\r\n  top: 2px;\r\n  left: 7px;\r\n  position: absolute;\r\n  width: 50px;\r\n  height: 4px;\r\n  background: #000;\r\n}\r\n\r\n.health-level-indicator {\r\n  height: 4px;\r\n}\r\n\r\n.health-level-indicator-high {\r\n  background: #0f0;\r\n}\r\n\r\n.health-level-indicator-normal {\r\n  background: #ff0;\r\n}\r\n\r\n.health-level-indicator-critical {\r\n  background: #f00;\r\n}\r\n\r\n.damage {\r\n  position: absolute;\r\n  width: var(--cell-size);\r\n  text-align: center;\r\n  z-index: 999;\r\n  color: #f00;\r\n  font-weight: bold;\r\n  animation: 500ms fade ease-out;\r\n}\r\n\r\n@keyframes fade {\r\n  from {\r\n    opacity: 0;\r\n    top: calc(var(--cell-size) * 0.5);\r\n    font-size: 1rem;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    top: -20px;\r\n    font-size: 1.5rem;\r\n  }\r\n}\r\n"],sourceRoot:""}]);const We=K},1113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1216:(e,t,r)=>{e.exports=r.p+"assets/map-tile-leftc75f062dddba6e98fdc6.png"},1265:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-left26b5f224d8750119922d.png"},1354:e=>{e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},1409:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top946aeb948db6313f1d85.png"},1605:(e,t,r)=>{e.exports=r.p+"assets/map-tile-center246277b8ca590816b3e8.png"},1906:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottomf462d2ed6eedca1e4fd9.png"},2076:(e,t,r)=>{e.exports=r.p+"assets/bowmancec542854b228e61547a.png"},2573:(e,t,r)=>{e.exports=r.p+"assets/map-tile-center0089a610e6611f679b50.png"},3062:(e,t,r)=>{e.exports=r.p+"assets/map-tile-lefteb1f6e4f87b977012684.png"},3160:(e,t,r)=>{e.exports=r.p+"assets/map-tile-center6f6f7c09bde970b2e41b.png"},3232:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-right0ac7f8258ec7166dc957.png"},3860:(e,t,r)=>{e.exports=r.p+"assets/daemoncf170a9fea1051b7424a.png"},3933:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top8b928c3eb136543e573a.png"},4041:(e,t,r)=>{e.exports=r.p+"assets/map-tile-left3d9503e0a850fda86f82.png"},4184:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottomf1703771380a9959d979.png"},4347:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-right6bacb8e25ed9ecf726bf.png"},4417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4437:(e,t,r)=>{e.exports=r.p+"assets/map-tile-right26fdc25019c24e87f11a.png"},4496:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-left258d884122fabfc2f312.png"},4875:(e,t,r)=>{e.exports=r.p+"assets/map-tile-right2c19971f327b288278bb.png"},5056:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},s=[],l=0;l<e.length;l++){var o=e[l],c=n.base?o[0]+n.base:o[0],h=i[c]||0,p="".concat(c," ").concat(h);i[c]=h+1;var d=r(p),m={css:o[1],media:o[2],sourceMap:o[3],supports:o[4],layer:o[5]};if(-1!==d)t[d].references++,t[d].updater(m);else{var u=a(m,n);n.byIndex=l,t.splice(l,0,{identifier:p,updater:u,references:1})}s.push(p)}return s}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var l=r(i[s]);t[l].references--}for(var o=n(e,a),c=0;c<i.length;c++){var h=r(i[c]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}i=o}}},5134:(e,t,r)=>{e.exports=r.p+"assets/map-tile-center51e2a5de56bd631452fe.png"},5513:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-right5cf9c17d6a1ea7106a6c.png"},5523:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom63aae58e4690953a3857.png"},6092:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-left13edb269e39172ddd74f.png"},6153:(e,t,r)=>{e.exports=r.p+"assets/map-tile-tope0aa3daf6d08c62c96d9.png"},6168:(e,t,r)=>{e.exports=r.p+"assets/swordsman2007ec00c1d9f997e704.png"},6267:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom07d5e8127645225478b6.png"},6291:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-righta1d2321024649b9d8f5f.png"},6314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r}).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var l=0;l<this.length;l++){var o=this[l][0];null!=o&&(s[o]=!0)}for(var c=0;c<e.length;c++){var h=[].concat(e[c]);n&&s[h[0]]||(void 0!==i&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=i),r&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=r):h[2]=r),a&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=a):h[4]="".concat(a)),t.push(h))}},t}},6318:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-leftef1b0ea8c4e545d9aadc.png"},6943:(e,t,r)=>{e.exports=r.p+"assets/magicianc0fa2b75539f94144dc4.png"},7335:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-lefteab6a2cc5e89a4dd8e3f.png"},7538:(e,t,r)=>{e.exports=r.p+"assets/map-tile-right22e7c5ede3f747cbe27a.png"},7659:e=>{var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},7825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7935:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-left46d63299c3420c030b4e.png"},7986:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-rightac9d74f57639792774bc.png"},8341:(e,t,r)=>{e.exports=r.p+"assets/generic0a77fc47d727eab6fd39.png"},8490:(e,t,r)=>{e.exports=r.p+"assets/map-tile-right6a84ae91f5d985ddc9ee.png"},8956:(e,t,r)=>{e.exports=r.p+"assets/map-tile-topdc3f97e7bbcd5ea1ded9.png"},9e3:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-rightd31d84c693f649766aee.png"},9221:(e,t,r)=>{e.exports=r.p+"assets/map-tile-top-right2f1e1970c2c20cf3a8d5.png"},9334:(e,t,r)=>{e.exports=r.p+"assets/zombie296dfeac15e2377fc1dc.png"},9593:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-leftb27323cf850ed820855c.png"},9702:(e,t,r)=>{e.exports=r.p+"assets/map-tile-bottom-left1d70f1dab2dd418c3612.png"},9745:(e,t,r)=>{e.exports=r.p+"assets/map-tile-left546abb060a0837550fd1.png"}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={id:n,exports:{}};return e[n](i,i.exports,r),i.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.p="",r.b=document.baseURI||self.location.href,r.nc=void 0;var n=r(5072),a=r.n(n),i=r(7825),s=r.n(i),l=r(7659),o=r.n(l),c=r(5056),h=r.n(c),p=r(540),d=r.n(p),m=r(1113),u=r.n(m),A=r(1016),g={};function f(e,t){var r=Math.floor(e/t),n=e%t,a=t-1;return 0===r&&0===n?"top-left":0===r&&n===a?"top-right":r===a&&0===n?"bottom-left":r===a&&n===a?"bottom-right":0===r?"top":r===a?"bottom":0===n?"left":n===a?"right":"center"}function b(e){return e<15?"critical":e<50?"normal":"high"}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function E(e,t,r){return(t=function(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t,r,n,a,i,s){try{var l=e[i](s),o=l.value}catch(e){return void r(e)}l.done?t(o):Promise.resolve(o).then(n,a)}function y(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(e){C(i,n,a,s,l,"next",e)}function l(e){C(i,n,a,s,l,"throw",e)}s(void 0)})}}g.styleTagTransform=u(),g.setAttributes=h(),g.insert=o().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=d(),a()(A.A,g),A.A&&A.A.locals&&A.A.locals;const w="prairie",x="desert",k="arctic",B="mountain";class L{constructor(e,t){if(new.target===L)throw new Error("Character is abstract");this.level=e,this.type=t,this.attack=0,this.defence=0,this.health=100}}class P{constructor(e,t){if(!(e instanceof L))throw new Error("character must be instance of Character or its children");if("number"!=typeof t)throw new Error("position must be a number");this.character=e,this.position=t}}class D extends L{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"bowman"),this.attack=25,this.defence=25}}class S extends L{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"swordsman"),this.attack=40,this.defence=10}}class T extends L{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"magician"),this.attack=10,this.defence=40}}class z extends L{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"vampire"),this.attack=25,this.defence=25}}class R extends L{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"undead"),this.attack=40,this.defence=10}}class U extends L{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"daemon"),this.attack=10,this.defence=10}}class M{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.characters=[],this.addAll(...e)}add(e){if(!(e instanceof L))throw new TypeError("Team accepts only Character instances");return this.characters.push(e),this}addAll(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(e=>this.add(e)),this}removeAt(e){if(e<0||e>=this.characters.length)return null;var[t]=this.characters.splice(e,1);return null!=t?t:null}clear(){this.characters.length=0}get size(){return this.characters.length}*[Symbol.iterator](){yield*this.characters}}function $(e,t,r){for(var n=function*(e,t){for(;;){var r=e[Math.floor(Math.random()*e.length)],n=Math.floor(Math.random()*t)+1;yield new r(n)}}(e,t),a=[],i=0;i<r;i+=1)a.push(n.next().value);return new M(a)}class G{constructor(){this.level=1,this.turn="player",this.locked=!1,this.selected=null,this.score=0,this.maxScore=0,this.round=1,this.theme=this.levelToTheme(this.level),this.positions=[]}static from(e){var t=new G;if(!e||"object"!=typeof e)return t;for(var r of["level","turn","locked","selected","score","maxScore","round","theme","positions"])r in e&&(t[r]=e[r]);return t.level<1&&(t.level=1),["player","ai"].includes(t.turn)||(t.turn="player"),Array.isArray(t.positions)||(t.positions=[]),"string"!=typeof t.theme&&(t.theme=t.levelToTheme(t.level)),t}levelToTheme(e){var t=["prairie","desert","arctic","mountain"];return t[Math.min(e-1,t.length-1)]}setSelected(e){this.selected=e}clearSelection(){this.selected=null}nextLevel(){this.level=Math.min(4,this.level+1),this.round=1,this.theme=this.levelToTheme(this.level),this.turn="player"}toJSON(){var{level:e,turn:t,locked:r,selected:n,score:a,maxScore:i,round:s,theme:l,positions:o}=this;return{level:e,turn:t,locked:r,selected:n,score:a,maxScore:i,round:s,theme:l,positions:o}}}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach(function(t){E(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var O=new class{constructor(){this.boardSize=8,this.container=null,this.boardEl=null,this.cells=[],this.cellClickListeners=[],this.cellEnterListeners=[],this.cellLeaveListeners=[],this.newGameListeners=[],this.saveGameListeners=[],this.loadGameListeners=[]}bindToDOM(e){if(!(e instanceof HTMLElement))throw new Error("container is not HTMLElement");this.container=e}drawUi(e){this.checkBinding(),this.container.innerHTML='\n      <div class="controls">\n        <button data-id="action-restart" class="btn">New Game</button>\n        <button data-id="action-save" class="btn">Save Game</button>\n        <button data-id="action-load" class="btn">Load Game</button>\n      </div>\n      <div class="board-container">\n        <div data-id="board" class="board"></div>\n      </div>\n    ',this.newGameEl=this.container.querySelector("[data-id=action-restart]"),this.saveGameEl=this.container.querySelector("[data-id=action-save]"),this.loadGameEl=this.container.querySelector("[data-id=action-load]"),this.newGameEl.addEventListener("click",e=>this.onNewGameClick(e)),this.saveGameEl.addEventListener("click",e=>this.onSaveGameClick(e)),this.loadGameEl.addEventListener("click",e=>this.onLoadGameClick(e)),this.boardEl=this.container.querySelector("[data-id=board]"),this.boardEl.classList.add(e);for(var t=0;t<this.boardSize**2;t+=1){var r=document.createElement("div");r.classList.add("cell","map-tile","map-tile-".concat(f(t,this.boardSize))),r.addEventListener("mouseenter",e=>this.onCellEnter(e)),r.addEventListener("mouseleave",e=>this.onCellLeave(e)),r.addEventListener("click",e=>this.onCellClick(e)),this.boardEl.appendChild(r)}this.cells=Array.from(this.boardEl.children)}redrawPositions(e){for(var t of this.cells)t.innerHTML="";for(var r of e){var n=this.boardEl.children[r.position],a=document.createElement("div");a.classList.add("character",r.character.type);var i=document.createElement("div");i.classList.add("health-level");var s=document.createElement("div");s.classList.add("health-level-indicator","health-level-indicator-".concat(b(r.character.health))),s.style.width="".concat(r.character.health,"%"),i.appendChild(s),a.appendChild(i),n.appendChild(a)}}addCellEnterListener(e){this.cellEnterListeners.push(e)}addCellLeaveListener(e){this.cellLeaveListeners.push(e)}addCellClickListener(e){this.cellClickListeners.push(e)}addNewGameListener(e){this.newGameListeners.push(e)}addSaveGameListener(e){this.saveGameListeners.push(e)}addLoadGameListener(e){this.loadGameListeners.push(e)}onCellEnter(e){e.preventDefault();var t=this.cells.indexOf(e.currentTarget);this.cellEnterListeners.forEach(e=>e.call(null,t))}onCellLeave(e){e.preventDefault();var t=this.cells.indexOf(e.currentTarget);this.cellLeaveListeners.forEach(e=>e.call(null,t))}onCellClick(e){var t=this.cells.indexOf(e.currentTarget);this.cellClickListeners.forEach(e=>e.call(null,t))}onNewGameClick(e){e.preventDefault(),this.newGameListeners.forEach(e=>e.call(null))}onSaveGameClick(e){e.preventDefault(),this.saveGameListeners.forEach(e=>e.call(null))}onLoadGameClick(e){e.preventDefault(),this.loadGameListeners.forEach(e=>e.call(null))}static showError(e){alert(e)}static showMessage(e){alert(e)}selectCell(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yellow";this.deselectCell(e),this.cells[e].classList.add("selected","selected-".concat(t))}deselectCell(e){var t=this.cells[e];t.classList.remove(...Array.from(t.classList).filter(e=>e.startsWith("selected")))}showCellTooltip(e,t){this.cells[t].title=e}hideCellTooltip(e){this.cells[e].title=""}showDamage(e,t){return new Promise(r=>{var n=this.cells[e],a=document.createElement("span");a.textContent=t,a.classList.add("damage"),n.appendChild(a),a.addEventListener("animationend",()=>{n.removeChild(a),r()})})}setCursor(e){this.boardEl.style.cursor=e}checkBinding(){if(null===this.container)throw new Error("GamePlay not bind to DOM")}};O.bindToDOM(document.querySelector("#game-container"));var H=new class{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"state";this.storage=e,this.key=t}save(e){var t=JSON.stringify(e);this.storage.setItem(this.key,t)}load(){var e=this.storage.getItem(this.key);if(!e)throw new Error("No saved state");try{return JSON.parse(e)}catch(e){throw new Error("Invalid saved state")}}clear(){this.storage.removeItem(this.key)}}(localStorage),q=new class{constructor(e,t){this.gamePlay=e,this.stateService=t,this.boardSize=8,this.playerTypes=[D,S,T],this.enemyTypes=[z,R,U],this.positions=[],this.selected=null,this.state=new G,this._lastHoverIndex=null,this.onCellEnter=this.onCellEnter.bind(this),this.onCellLeave=this.onCellLeave.bind(this),this.onCellClick=this.onCellClick.bind(this)}showError(e){"function"==typeof this.gamePlay.showError?this.gamePlay.showError(e):"function"==typeof this.gamePlay.showMessage?this.gamePlay.showMessage(e):"undefined"!=typeof window&&window.alert(e)}clearHighlights(){for(var e=this.boardSize*this.boardSize,t=0;t<e;t+=1)this.gamePlay.deselectCell(t);this._lastHoverIndex=null}init(){var e,t,r,n,a,i;this.applyThemeForLevel(this.state.level),this.gamePlay.addCellEnterListener(this.onCellEnter),this.gamePlay.addCellLeaveListener(this.onCellLeave),this.gamePlay.addCellClickListener(this.onCellClick),null===(e=(t=this.gamePlay).addNewGameListener)||void 0===e||e.call(t,()=>this.newGame()),null===(r=(n=this.gamePlay).addSaveGameListener)||void 0===r||r.call(n,()=>this.saveGame()),null===(a=(i=this.gamePlay).addLoadGameListener)||void 0===a||a.call(i,()=>this.loadGame());try{var s=this.stateService.load();this.deserialize(s),this.applyThemeForLevel(this.state.level),this.gamePlay.redrawPositions(this.positions)}catch(e){this.newGame(!0)}}onCellClick(e){if(!this.state.locked){var t=this.getPCAt(e),{selected:r}=this;if(t&&this.isPlayerCharacter(t))return r&&r.position!==e&&this.gamePlay.deselectCell(r.position),this.selected=t,this.state.setSelected(e),void this.gamePlay.selectCell(e);if(r){var{move:n,attack:a}=this.rangeByType(r.character.type),i=this.reachableBySteps(r.position,n),s=this.attackRadius(r.position,a);if(!t&&i.has(e))return r.position=e,void this.afterPlayerAction();t&&!this.isPlayerCharacter(t)&&s.has(e)?this.attack(r,t).then(()=>this.afterPlayerAction()):this.showError("Недопустимое действие")}else this.showError("Выберите своего персонажа")}}onCellEnter(e){if(!this.state.locked){var t=this.getPCAt(e);t&&this.gamePlay.showCellTooltip(function(e){var{level:t,attack:r,defence:n,health:a}=e;return"🎖".concat(t," ⚔").concat(r," 🛡").concat(n," ❤").concat(a)}(t.character),e),null!==this._lastHoverIndex&&this._lastHoverIndex!==this.state.selected&&this._lastHoverIndex!==e&&this.gamePlay.deselectCell(this._lastHoverIndex),this._lastHoverIndex=e,this.updateCursorAndHighlights(e)}}onCellLeave(e){this.state.locked||(this.gamePlay.hideCellTooltip(e),this.selected&&this.selected.position===e||this.gamePlay.deselectCell(e),this._lastHoverIndex===e&&(this._lastHoverIndex=null),this.gamePlay.setCursor("auto"))}updateCursorAndHighlights(e){var{selected:t}=this,r=this.getPCAt(e);if(r&&this.isPlayerCharacter(r))this.gamePlay.setCursor("pointer");else if(t){var{move:n,attack:a}=this.rangeByType(t.character.type),i=!r&&this.reachableBySteps(t.position,n).has(e),s=r&&!this.isPlayerCharacter(r)&&this.attackRadius(t.position,a).has(e);i?(this.gamePlay.setCursor("pointer"),this.gamePlay.selectCell(e,"green")):s?(this.gamePlay.setCursor("crosshair"),this.gamePlay.selectCell(e,"red")):this.gamePlay.setCursor("notallowed")}else this.gamePlay.setCursor("notallowed")}afterPlayerAction(){this.clearHighlights(),this.state.clearSelection(),this.selected=null,this.gamePlay.redrawPositions(this.positions),this.checkEndConditions()||(this.state.turn="ai",this.save(),this.aiTurn())}aiTurn(){var e=this;return y(function*(){if(!e.state.locked){e.clearHighlights();var t,r=e.positions.filter(t=>!e.isPlayerCharacter(t)),n=e.positions.filter(t=>e.isPlayerCharacter(t)),a=function*(){var{attack:t}=e.rangeByType(i.character.type),r=e.attackRadius(i.position,t),a=n.find(e=>r.has(e.position));if(a)return yield e.attack(i,a),e.gamePlay.redrawPositions(e.positions),e.checkEndConditions()||(e.state.turn="player",e.save()),{v:void 0}};for(var i of r)if(t=yield*a())return t.v;var s=new Set(e.positions.map(e=>e.position)),l=r[0],o=(t=>{var{move:r}=e.rangeByType(t.character.type),a=[...e.reachableBySteps(t.position,r)].filter(e=>!s.has(e));if(0===a.length)return t.position;var i=a[0],l=1/0,o=function(t){var r=Math.min(...n.map(r=>e.chebyshev(t,r.position)));r<l&&(l=r,i=t)};for(var c of a)o(c);return i})(l);l.position=o,e.gamePlay.redrawPositions(e.positions),e.checkEndConditions()||(e.state.turn="player",e.save())}})()}attack(e,t){var r=this;return y(function*(){var n=e.character,a=t.character,i=Math.max(n.attack-a.defence,Math.floor(.1*n.attack));if(a.health=Math.max(0,a.health-i),yield r.gamePlay.showDamage(t.position,i),0===a.health){var s=!r.isPlayerCharacter(t);r.positions=r.positions.filter(e=>e!==t),s&&(r.state.score+=100)}r.gamePlay.redrawPositions(r.positions)})()}checkEndConditions(){var e=this.positions.some(e=>this.isPlayerCharacter(e)),t=this.positions.some(e=>!this.isPlayerCharacter(e));return e?!t&&(this.levelUpPlayers(),this.state.level<4?(this.state.level+=1,this.applyThemeForLevel(this.state.level),this.spawnNewWave(),this.state.turn="player",this.save(),this.gamePlay.redrawPositions(this.positions),!0):(this.state.locked=!0,this.state.maxScore=Math.max(this.state.maxScore,this.state.score),this.save(),this.showError("Победа! Все уровни пройдены"),!0)):(this.state.locked=!0,this.state.maxScore=Math.max(this.state.maxScore,this.state.score),this.save(),this.showError("Game Over"),!0)}newGame(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.state.maxScore:0;this.state=new G,this.state.maxScore=e,this.selected=null,this._lastHoverIndex=null,this.applyThemeForLevel(this.state.level),this.spawnInitialTeams(),this.clearHighlights(),this.gamePlay.redrawPositions(this.positions),this.save()}spawnInitialTeams(){var e=this;this.positions=[];var t=$(this.playerTypes,2,3),r=$(this.enemyTypes,2,3),n=new Set([...Array(this.boardSize*this.boardSize)].map((e,t)=>t)),a=(t,r)=>{t.characters.forEach(t=>{for(var a=[],i=function(t){r.forEach(r=>{var i=e.rcToIndex(t,r);n.has(i)&&a.push(i)})},s=0;s<this.boardSize;s+=1)i(s);var l=this.getRandomFreeCell(a);n.delete(l),this.positions.push(new P(t,l))})};a(t,[0,1]),a(r,[6,7])}spawnNewWave(){var e=this,t=this.positions.filter(e=>this.isPlayerCharacter(e));if(!(this.positions.filter(e=>!this.isPlayerCharacter(e)).length>0)){var r=Math.max(3,t.length+1),n=Math.min(4,this.state.level),a=$(this.enemyTypes,n,r),i=new Set([...Array(this.boardSize*this.boardSize)].map((e,t)=>t));t.forEach(e=>i.delete(e.position));var s=[6,7];a.characters.forEach(t=>{for(var r=[],n=function(t){s.forEach(n=>{var a=e.rcToIndex(t,n);i.has(a)&&r.push(a)})},a=0;a<this.boardSize;a+=1)n(a);if(0!==r.length){var l=this.getRandomFreeCell(r);i.delete(l),this.positions.push(new P(t,l))}})}}levelUpPlayers(){this.positions.forEach(e=>{if(this.isPlayerCharacter(e)){var t=e.character;t.level=Math.min(4,t.level+1);var r=Math.min(100,t.level+80),n=(80+t.health)/100;t.attack=Math.max(t.attack,Math.floor(t.attack*n)),t.defence=Math.max(t.defence,Math.floor(t.defence*n)),t.health=r}})}applyThemeForLevel(e){var t=[w,x,k,B],r=t[Math.min(e-1,t.length-1)];this.state.theme=r,this.gamePlay.drawUi(r)}isPlayerCharacter(e){return["bowman","swordsman","magician"].includes(e.character.type)}getPCAt(e){return this.positions.find(t=>t.position===e)}rangeByType(e){switch(e){case"swordsman":case"undead":return{move:4,attack:1};case"bowman":case"vampire":return{move:2,attack:2};case"magician":case"daemon":return{move:1,attack:4};default:return{move:1,attack:1}}}indexToRC(e){return{r:Math.floor(e/this.boardSize),c:e%this.boardSize}}rcToIndex(e,t){return e*this.boardSize+t}chebyshev(e,t){var r=this.indexToRC(e),n=this.indexToRC(t);return Math.max(Math.abs(r.r-n.r),Math.abs(r.c-n.c))}reachableBySteps(e,t){var{r,c:n}=this.indexToRC(e),a=new Set;return[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]].forEach(e=>{for(var[i,s]=e,l=1;l<=t;l+=1){var o=r+i*l,c=n+s*l;if(o<0||c<0||o>=this.boardSize||c>=this.boardSize)break;a.add(this.rcToIndex(o,c))}}),a}attackRadius(e,t){for(var{r,c:n}=this.indexToRC(e),a=new Set,i=0;i<this.boardSize;i+=1)for(var s=0;s<this.boardSize;s+=1)i===r&&s===n||Math.max(Math.abs(i-r),Math.abs(s-n))<=t&&a.add(this.rcToIndex(i,s));return a}getRandomFreeCell(e){if(!e.length)throw new Error("No free cells to place a character");return e[Math.floor(Math.random()*e.length)]}typeToCtor(e){switch(e){case"bowman":return D;case"swordsman":return S;case"magician":return T;case"vampire":return z;case"undead":return R;case"daemon":return U;default:throw new Error("Unknown type: ".concat(e))}}save(){try{this.state.positions=this.positions.map(e=>({position:e.position,character:{type:e.character.type,level:e.character.level,attack:e.character.attack,defence:e.character.defence,health:e.character.health}})),this.stateService.save(this.state)}catch(e){}}saveGame(){this.save()}loadGame(){try{var e=this.stateService.load();this.deserialize(e),this.applyThemeForLevel(this.state.level),this.clearHighlights(),this.gamePlay.redrawPositions(this.positions)}catch(e){this.showError("Не удалось загрузить сохранение")}}deserialize(e){if(e&&"state"in e&&"positions"in e){var t=I(I({},e.state),{},{positions:e.positions});this.state=G.from(t)}else this.state=G.from(e);if(this.positions=this.state.positions.map(e=>{var t=new(this.typeToCtor(e.character.type))(1);return t.level=e.character.level,t.attack=e.character.attack,t.defence=e.character.defence,t.health=e.character.health,new P(t,e.position)}),Number.isInteger(this.state.selected)){var r=this.getPCAt(this.state.selected);r?(this.selected=r,this.gamePlay.selectCell(this.state.selected)):(this.state.clearSelection(),this.selected=null)}}}(O,H);q.init()})();
//# sourceMappingURL=main.8aad9270f7421995fc65.js.map